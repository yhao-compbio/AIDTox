# This folder contains results generated by the repository.

## Implementing AIDTox visible neural network model on compound comptoxAI connections-Tox21 assay outcome datasets 

+ First, hyperparameter tuning of AIDTox model was performed to find the optimal setting for each Tox21 dataset. One hyperparamter was tuned for AIDTox implementation: root biological processes ('rt', values for implementation: 'gene expression', 'immune system', 'metabolism', 'signal transduction' and all possible combinations of the four pathways, 15 in total). Model performance was measured using binary cross-entropy (BCE) loss, area under ROC curve (AUROC), balanced accuracy, and F1 score. Details about model statistics and performance can be found [here](compound_select_gene_comptoxai_tox21_implementation/compound_select_gene_comptoxai_tox21_implementation_performance_summary.tsv). Training BCE loss was employed to identify the optimal hyperparameter setting for each dataset. (see [optimal model performance](compound_select_gene_comptoxai_tox21_implementation/compound_select_gene_comptoxai_tox21_implementation_optimal_performance_summary_by_training_root_loss.tsv))

+ Next, the optimal performance was first compared across the five values of number of top predictive ComptoxAI-connected gene features for each dataset. In general, as more predictive genes were incorporated, we observed an improvement in the resulting model performance (decline in training loss) until 400. Across different datasets, models derived from top 400 predictive genes tend to result in the best performance. Therefore, we proceeded with models built using the top 400 predictive genes. The optimal performance was then compared across models derived from three distinct connection types: physical binding (with protein product), expression-alteration (up-regulation/down-regulation), and combined (binding and expression). Across datasets, models derived from binding connections significantly outperform the other types. Therefore, we proceeded with models derived from binding connections, the final form of AIDTox model. 

+ Finally, validation performance of optimal AIDTox visible neural network model ([AIDTox](compound_select_gene_comptoxai_tox21_implementation/compound_select_gene_comptoxai_tox21_implementation_optimal_performance_summary_by_training_root_loss.tsv)) was compared against [three other methods](compound_select_gene_comptoxai_tox21_implementation/compound_select_gene_comptoxai_tox21_compare_files.tsv):
  + DTox visible neural network model with the same setting as optimal model but using inferred target binding profile as input features ([DTox](compound_comptoxai_target_probability_tox21_implementation/select_gene_comptoxai/compound_target_probability_compare_select_gene_comptoxai_binding_dtox_performance_summary.tsv))
  + optimal random forest QSAR model (using compound MACCS fingerprints as input features) after hyperparameter tuning ([QSAR-RF](compound_structure_tox21_simple/select_gene_comptoxai/binding/randomforest/compound_structure_fingerprint_maccs_compare_select_gene_comptoxai_binding_tox21_simple_randomforest_optimal_performance_summary_by_training_log_loss.tsv)), full results before tuning can be found [here](compound_structure_tox21_simple/select_gene_comptoxai/binding/randomforest/compound_structure_fingerprint_maccs_compare_select_gene_comptoxai_binding_tox21_simple_randomforest_performance_summary.tsv) 
  + optimal gradient boosting QSAR model (using compound MACCS fingerprints as input features) after hyperparameter tuning ([QSAR-GB](compound_structure_tox21_simple/select_gene_comptoxai/binding/xgboost/compound_structure_fingerprint_maccs_compare_select_gene_comptoxai_binding_tox21_simple_xgboost_optimal_performance_summary_by_training_log_loss.tsv)), full results before tuning can be found [here](compound_structure_tox21_simple/select_gene_comptoxai/binding/xgboost/compound_structure_fingerprint_maccs_compare_select_gene_comptoxai_binding_tox21_simple_xgboost_performance_summary.tsv)

## Implementing interpretation framework to explain HEK293 and HepG2 cytotoxicity predicted by AIDTox models

+ First, the interpretation framework (same as DTox) was implemented to identity VNN paths connecting cytotoxic compounds to the outcome for [HEK293 cytotoxicity](compound_select_gene_comptoxai_tox21_interpret/binding/gamma-epsilon_0.001_0.1/compound_select_gene_comptoxai_binding_tox21-rt-viability-hek293-p1_400_rt_33_ps_5_re_0_st_0_xs_20_al_0.5_ld_1e-04_model.pt_gamma-epsilon_0.001_0.1_path_relevance_pv.tsv) and [HepG2 cytotoxicity](compound_select_gene_comptoxai_tox21_interpret/binding/gamma-epsilon_0.001_0.1/compound_select_gene_comptoxai_binding_tox21-rt-viability-hepg2-p1_400_rt_33_ps_5_re_0_st_0_xs_20_al_0.5_ld_1e-04_model.pt_gamma-epsilon_0.001_0.1_path_relevance_pv.tsv).

+ Next, we focused on a [subset of identified VNN paths that are supported by ComptoxAI connections](compound_select_gene_comptoxai_tox21_interpret_analysis/compound_select_gene_comptoxai_binding_tox21-rt-viability-hek293-p1_400_rt_33_ps_5_re_0_st_0_xs_20_al_0.5_ld_1e-04_model.pt_gamma-epsilon_0.001_0.1_target_path_relevance_pv.tsv). We analyzed these identified VNN paths related to [tubulin proteins](compound_select_gene_comptoxai_tox21_interpret_analysis/tubulin_pathway_relations.tsv), [cytochrome P450 enzymes](compound_select_gene_comptoxai_tox21_interpret_analysis/cytochrome_p450_pathway_relations.tsv), [ATP-binding cassette transporters](compound_select_gene_comptoxai_tox21_interpret_analysis/abc_pathway_relations.tsv), and [dasatinib](compound_select_gene_comptoxai_tox21_interpret_analysis/dasatinib_pathway_relations.tsv).


